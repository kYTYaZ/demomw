/*
 * FilePondPluginImageCrop 2.0.0
 * Licensed under MIT, https://opensource.org/licenses/MIT
 * Please visit https://pqina.nl/filepond for details.
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.FilePondPluginImageCrop=e()}(this,function(){"use strict";var l=function(t){return/^image/.test(t.type)},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t=function(t){var e=t.addFilter,n=t.utils,o=n.Type,a=n.isFile,u=n.getNumericAspectRatioFromString,c=function(t,e){return!(!l(t.file)||!e("GET_ALLOW_IMAGE_CROP"))},f=function(t){return"object"===(void 0===t?"undefined":r(t))},p=function(t){return"number"==typeof t},d=function(t,e){return t.setMetadata("crop",Object.assign({},t.getMetadata("crop"),e))};return e("DID_CREATE_ITEM",function(r,t){var i=t.query;r.extend("setImageCrop",function(t){if(c(r,i)&&f(center))return r.setMetadata("crop",t),t}),r.extend("setImageCropCenter",function(t){if(c(r,i)&&f(t))return d(r,{center:t})}),r.extend("setImageCropZoom",function(t){if(c(r,i)&&p(t))return d(r,{zoom:Math.max(1,t)})}),r.extend("setImageCropRotation",function(t){if(c(r,i)&&p(t))return d(r,{rotation:t})}),r.extend("setImageCropFlip",function(t){if(c(r,i)&&f(t))return d(r,{flip:t})}),r.extend("setImageCropAspectRatio",function(t){if(c(r,i)&&void 0!==t){var e=r.getMetadata("crop"),n=u(t),o={center:{x:.5,y:.5},flip:e?Object.assign({},e.flip):{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:n};return r.setMetadata("crop",o),o}})}),e("DID_LOAD_ITEM",function(r,t){var i=t.query;return new Promise(function(t,e){var n=r.file;if(!a(n)||!l(n)||!i("GET_ALLOW_IMAGE_CROP"))return t(r);if(r.getMetadata("crop"))return t(r);var o=i("GET_IMAGE_CROP_ASPECT_RATIO");r.setMetadata("crop",{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},rotation:0,zoom:1,aspectRatio:o?u(o):null}),t(r)})}),{options:{allowImageCrop:[!0,o.BOOLEAN],imageCropAspectRatio:[null,o.STRING]}}};return"undefined"!=typeof window&&void 0!==window.document&&document&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:t})),t});